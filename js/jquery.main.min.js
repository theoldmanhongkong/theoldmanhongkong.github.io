function initHeightWin() {
    if (jQuery(window).width() < 1024) {
        jQuery(".intro-section").outerHeight();
        jQuery(".intro-section").css({
            height: "number" == typeof window.innerHeight ? window.innerHeight : document.documentElement.clientHeight
        })
    }
}

function initAnchors() {
    new SmoothScroll({
        anchorLinks: ".anchor",
        extraOffset: 0,
        wheelBehavior: "none"
    })
}

function initialize() {
    appendInfo(), slickCarousel(), clickHandlers(), destroySlider(), scrollToElement(), createParallax()
}

function addSubscriber(t) {
    var e = new FormData($("#email-" + t).parent()[0]);
    $.ajax({
        type: "post",
        url: "lib/send-form.php",
        data: e,
        contentType: !1,
        processData: !1,
        success: function(t) {
            var e = $.parseJSON(t),
                i = "";
            e.error && (i = e.error.detail), 200 == e.status || 201 == e.status || "This email address is already subscribed." == i ? ($(".form-subscribe input").hide(), $(".msg-newsletter").empty().append("Thank you.<br> Stay tuned for upcoming news and events.").addClass("subscribed").fadeIn(800)) : $(".msg-newsletter").empty().append(i).fadeIn(800)
        }
    })
}

function clickHandlers() {
    $(".btn-subscribe").click(function(t) {
        t.preventDefault(), addSubscriber($(this).data("email-field"))
    }), $(".checkbox-toggle").on("click", function() {
        $(".outer-menu").toggleClass("opened")
    }), $(".mobile-nav a").on("click", function() {
        setTimeout(function() {
            $(".checkbox-toggle").prop("checked", !1), $(".outer-menu").toggleClass("opened")
        }, 1e3)
    })
}

function slickCarousel() {
    $(".hero-slider").slick({
        dots: !0,
        slidesToShow: 1,
        adaptiveHeight: !0,
        arrows: !1,
        autoplay: !0,
        autoplaySpeed: 8e3,
        fade: !0,
        cssEase: "linear"
    }), $(".story__slider").slick({
        prevArrow: "",
        nextArrow: '<i class="fas fa-angle-right"></i>'
    }), $(".menu .hero-slider").on("beforeChange", function(t, e, i, n) {
        var o = $(".menu .hero-slider .header:nth-child(" + (n + 1) + ")"),
            a = o.data("title"),
            r = o.data("description");
        $(".featured-drink-title").fadeOut(function() {
            $(this).html(a).fadeIn()
        }), $(".featured-drink-description").fadeOut(function() {
            $(this).html(r).fadeIn()
        })
    })
}

function appendInfo() {
    var t = "852.2703.1899",
        e = "john.aexel.iii@theoldmanhongkong.com",
        i = "nikita@theoldmanhongkong.com";
    $(".email").attr("href", "mailto:" + e).text(e), $(".roman-email").attr("href", "mailto:" + i).text(i), $(".footer__phone").attr("href", "tel:" + t), $(".footer__email").attr("href", "mailto:" + e), $(".footer__phone p").text(t), $(".footer__email p").text(e)
}

function destroySlider() {
    var t = $("#wrapper").width(),
        e = $(".story__slider");
    768 < t && e.hasClass("slick-initialized") ? e.slick("unslick") : t < 768 && !e.hasClass("slick-initialized") && e.slick({
        prevArrow: "",
        nextArrow: '<i class="fas fa-angle-right"></i>'
    })
}

function scrollToElement() {
    $('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function(t) {
        if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && location.hostname == this.hostname) {
            var e = $(this.hash);
            (e = e.length ? e : $("[name=" + this.hash.slice(1) + "]")).length && (t.preventDefault(), $("html, body").animate({
                scrollTop: e.offset().top
            }, 1e3, function() {}))
        }
    })
}

function createParallax() {
    var t = [],
        e = $(".scene"),
        n = $("#wrapper").width();
    for (i = 0; i < e.length; i++) t[i] = new Parallax(e[i]), n < 768 ? t[i].scalar() : t[i].scalar(2, 2)
}
jQuery(function() {
        initAnchors(), initHeightWin()
    }), jQuery(window).on("resize", function() {
        initHeightWin()
    }),
    function(c, t) {
        var o, a, r, h = c(window),
            s = "onwheel" in document || 9 <= document.documentMode ? "wheel" : "mousewheel DOMMouseScroll";

        function n(t, e, i) {
            var n;
            document.body && (e = "number" == typeof e ? {
                duration: e
            } : e || {}, o = o || c("html, body"), n = e.container || o, "number" == typeof t && (t = {
                top: t
            }), a && r && a.off(s, r), e.wheelBehavior && "none" !== e.wheelBehavior && (r = function(t) {
                "stop" === e.wheelBehavior ? (n.off(s, r), n.stop()) : "ignore" === e.wheelBehavior && t.preventDefault()
            }, a = n.on(s, r)), n.stop().animate({
                scrollLeft: t.left,
                scrollTop: t.top
            }, e.duration, function() {
                r && n.off(s, r), c.isFunction(i) && i()
            }))
        }

        function e(t) {
            this.options = c.extend({
                anchorLinks: 'a[href^="#"]',
                container: null,
                extraOffset: null,
                activeClasses: null,
                easing: "swing",
                animMode: "duration",
                animDuration: 800,
                animSpeed: 1500,
                anchorActiveClass: "anchor-active",
                sectionActiveClass: "section-active",
                wheelBehavior: "stop",
                useNativeAnchorScrolling: !1
            }, t), this.init()
        }
        e.prototype = {
            init: function() {
                this.initStructure(), this.attachEvents(), this.isInit = !0
            },
            initStructure: function() {
                var t = this;
                this.container = this.options.container ? c(this.options.container) : c("html,body"), this.scrollContainer = this.options.container ? this.container : h, this.anchorLinks = jQuery(this.options.anchorLinks).filter(function() {
                    return jQuery(t.getAnchorTarget(jQuery(this))).length
                })
            },
            getId: function(t) {
                try {
                    return "#" + t.replace(/^.*?(#|$)/, "")
                } catch (t) {
                    return null
                }
            },
            getAnchorTarget: function(t) {
                var e = this.getId(c(t).attr("href"));
                return c(1 < e.length ? e : "html")
            },
            getTargetOffset: function(t) {
                var e = t.offset().top;
                return this.options.container && (e -= this.container.offset().top - this.container.prop("scrollTop")), "number" == typeof this.options.extraOffset ? e -= this.options.extraOffset : "function" == typeof this.options.extraOffset && (e -= this.options.extraOffset(t)), {
                    top: e
                }
            },
            attachEvents: function() {
                var e = this;
                if (this.options.activeClasses && this.anchorLinks.length) {
                    this.anchorData = [];
                    for (var t = 0; t < this.anchorLinks.length; t++) {
                        var i = jQuery(this.anchorLinks[t]),
                            n = e.getAnchorTarget(i),
                            o = null;
                        c.each(e.anchorData, function(t, e) {
                            e.block[0] === n[0] && (o = e)
                        }), o ? o.link = o.link.add(i) : e.anchorData.push({
                            link: i,
                            block: n
                        })
                    }
                    this.resizeHandler = function() {
                        e.isInit && e.recalculateOffsets()
                    }, this.scrollHandler = function() {
                        e.refreshActiveClass()
                    }, this.recalculateOffsets(), this.scrollContainer.on("scroll", this.scrollHandler), h.on("resize load orientationchange refreshAnchor", this.resizeHandler)
                }
                this.clickHandler = function(t) {
                    e.onClick(t)
                }, this.options.useNativeAnchorScrolling || this.anchorLinks.on("click", this.clickHandler)
            },
            recalculateOffsets: function() {
                var i = this;
                c.each(this.anchorData, function(t, e) {
                    e.offset = i.getTargetOffset(e.block), e.height = e.block.outerHeight()
                }), this.refreshActiveClass()
            },
            toggleActiveClass: function(t, e, i) {
                t.toggleClass(this.options.anchorActiveClass, i), e.toggleClass(this.options.sectionActiveClass, i)
            },
            refreshActiveClass: function() {
                var o = this,
                    a = !1,
                    r = this.container.prop("scrollHeight"),
                    s = this.scrollContainer.height(),
                    l = this.options.container ? this.container.prop("scrollTop") : h.scrollTop();
                this.options.customScrollHandler ? this.options.customScrollHandler.call(this, l, this.anchorData) : (this.anchorData.sort(function(t, e) {
                    return t.offset.top - e.offset.top
                }), c.each(this.anchorData, function(t) {
                    var e = o.anchorData.length - t - 1,
                        i = o.anchorData[e],
                        n = "parent" === o.options.activeClasses ? i.link.parent() : i.link;
                    r - s <= l ? e === o.anchorData.length - 1 ? o.toggleActiveClass(n, i.block, !0) : o.toggleActiveClass(n, i.block, !1) : !a && (l >= i.offset.top - 1 || 0 === e) ? (a = !0, o.toggleActiveClass(n, i.block, !0)) : o.toggleActiveClass(n, i.block, !1)
                }))
            },
            calculateScrollDuration: function(t) {
                return "speed" === this.options.animMode ? Math.abs(this.scrollContainer.scrollTop() - t.top) / this.options.animSpeed * 1e3 : this.options.animDuration
            },
            onClick: function(t) {
                var e = this.getAnchorTarget(t.currentTarget),
                    i = this.getTargetOffset(e);
                t.preventDefault(), n(i, {
                    container: this.container,
                    wheelBehavior: this.options.wheelBehavior,
                    duration: this.calculateScrollDuration(i)
                }), this.makeCallback("onBeforeScroll", t.currentTarget)
            },
            makeCallback: function(t) {
                if ("function" == typeof this.options[t]) {
                    var e = Array.prototype.slice.call(arguments);
                    e.shift(), this.options[t].apply(this, e)
                }
            },
            destroy: function() {
                var o = this;
                this.isInit = !1, this.options.activeClasses && (h.off("resize load orientationchange refreshAnchor", this.resizeHandler), this.scrollContainer.off("scroll", this.scrollHandler), c.each(this.anchorData, function(t) {
                    var e = o.anchorData.length - t - 1,
                        i = o.anchorData[e],
                        n = "parent" === o.options.activeClasses ? i.link.parent() : i.link;
                    o.toggleActiveClass(n, i.block, !1)
                })), this.anchorLinks.off("click", this.clickHandler)
            }
        }, c.extend(e, {
            scrollTo: function(t, e, i) {
                n(t, e, i)
            }
        }), t.SmoothScroll = e
    }(jQuery, this), $(document).ready(initialize), $(window).resize(destroySlider);